<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="run" name="Create Runnable Jar for Project SDT">
	<!--this file was created by Eclipse Runnable JAR Export Wizard-->
	<!--ANT 1.7 is required                                        -->

	<!-- set global properties for this build -->
	<property name="src" location="src"/>
	<property name="build" value="classes"/>
	<property name="dist" value="dist2"/>
	<property name="javadoc" value="javadoc/"/>
	
	<!-- version major.minor.build major and minor should be set manually, build is auto increment by EE test -->
	<property name="version" value="0.0.3594"/>
	<property name="jarName" value="sdt-framework-${version}.jar"/>
	<property name="srcJarName" value="sdt-framework-${version}-sources.jar"/>
	<property name="docJarName" value="sdt-framework-${version}-javadoc.jar"/>

	<path id="compile_classpath">
        <pathelement location="${build}"/>
        <fileset dir="libs">
			<include name="**/*.jar"/>
        </fileset>
    </path>

    <path id="run_classpath">
        <fileset dir="libs">
            <include name="*.jar"/>
        </fileset>
        <fileset dir="dist">
            <include name="*.jar"/>
        </fileset>
    </path>
    
	<target name="init">
		<!-- Create the time stamp -->
		<tstamp/>
		<!-- Create the build directory structure used by compile -->
		<delete dir="${build}"/>
		<delete dir="${dist}"/>
		<delete dir="${javadoc}"/>
		<mkdir dir="${build}"/>
		<mkdir dir="${dist}"/>
		<mkdir dir="${javadoc}"/>
	</target>

	<target name="compile" depends="init" description="compile the source" >
		<!-- Compile the java code from ${src} into ${build} -->
		<javac srcdir="${src}" destdir="${build}" debug="true" includeantruntime="false">
			<classpath refid="compile_classpath"/>
			<src path="${src}" />
			<exclude name="com/macys/sdt/projects/**" />
		</javac>
	</target>

	<!-- Generate javadocs for current project into ${doc.dir} -->
	<target name="create_javadoc" depends="init" description="generate documentation">
		<javadoc
				destdir="${javadoc}"
				author="true" version="true"
				use="true"
				doctitle="SDT Framework" >
			<fileset dir="${src}" defaultexcludes="yes">
				<include name="com/macys/sdt/framework/**/*.java"/>
				<include name="com/macys/sdt/shared/**/*.java" />
				<exclude name="com/macys/sdt/projects/**" />
			</fileset>
		</javadoc>
		<!-- javadoc.jar -->
		<jar destfile="${dist}/${docJarName}">
			<fileset dir="${javadoc}"/>
		</jar>
	</target>

	<target name="package" depends="compile">
        <jar destfile="${dist}/${jarName}">
        <fileset dir="${build}"/>
        </jar>
    </target>

	<target name="all_packages" depends="create_run_jar,create_javadoc">
		<!-- source.jar -->
		<jar destfile="${dist}/${srcJarName}">
			<fileset dir="${src}"
					 includes="**/*.java"
					 excludes="com/macys/sdt/projects/**"
					/>
		</jar>
	</target>
  
	<target name="run" depends="package">
        <java classname="com.macys.sdt.framework.runner.MainRunner" failonerror="true" fork="true">
            <classpath refid="run_classpath"/>
            <classpath>
            <pathelement location="src/"/>
            </classpath>
        </java>
    </target>

	<target name="create_run_jar" depends="compile">
		<delete dir="${build}"/>
		<mkdir dir="${build}"/>
		<path id="master-classpath">
			<fileset dir="libs">
				<include name="**/*.jar"/>
			</fileset>
			<pathelement path="${build}"/>
		</path>

		<javac srcdir="${src}" destdir="${build}" debug="true">
			<classpath refid="master-classpath"/>
			<src path="${src}" />
			<exclude name="com/macys/sdt/projects/**" />
		</javac>

		<copy todir="${build}">
			<fileset dir="src"
		     includes="**/*"
		     />
		</copy>

		<jar destfile="${dist}/${jarName}" filesetmanifest="mergewithoutmain">
			<manifest>
				<attribute name="Main-Class" value="sdt.utils.RunFeature"/>
				<attribute name="Class-Path" value="."/>
			</manifest>
			<fileset dir="${build}"/>
			<fileset dir="${src}" includes="**/*.java"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/browsermob-dist-2.1.0-beta-2.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/commons-collections4-4.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/commons-compress-1.9.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/commons-httpclient-3.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/cucumber-core-1.2.4.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/cucumber-html-0.2.3.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/cucumber-java-1.2.4.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/cucumber-junit-1.2.4.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/cucumber-jvm-deps-1.0.5.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/db2jcc4-10.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/db2-jcc-license-4-2.8.46.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/gherkin-2.12.2.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/guava-18.0.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/hamcrest-all-1.3.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jackson-core-asl-1.9.13.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jackson-mapper-asl-1.9.13.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/java-json.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/javalite-common-1.4.11.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/junit-4.12.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/selenium-server-standalone-2.53.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/slf4j-api-1.7.19.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/xercesImpl.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/xml-apis.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/java-client-3.4.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/api/javax.ws.rs-api-2.0.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/lib/jersey-client.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/lib/jersey-common.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/lib/jersey-container-servlet.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/lib/jersey-container-servlet-core.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/lib/jersey-media-jaxb.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/lib/jersey-server.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/aopalliance-repackaged-2.4.0-b34.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/asm-debug-all-5.0.4.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/hk2-api-2.4.0-b34.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/hk2-locator-2.4.0-b34.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/hk2-utils-2.4.0-b34.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/javassist-3.18.1-GA.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/javax.annotation-api-1.2.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/javax.inject-2.4.0-b34.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/javax.servlet-api-3.0.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/jaxb-api-2.2.7.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/jersey-guava-2.23.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/org.osgi.core-4.2.0.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/osgi-resource-locator-1.0.1.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/persistence-api-1.0.jar"/>
			<zipfileset excludes="META-INF/*.SF" src="libs/jaxrs-ri-2.23.1/ext/validation-api-1.1.0.Final.jar"/>
		</jar>

	</target>
</project>
